# Ch.01 스마트 계약 개발 이해하기

## 계약

### 기존 계약 방식의 문제점

1. 계약 내용을 서로 다르게 인식
2. 계약 불이행
3. 계약 절차의 복잡함

### 스마트 계약의 필수 조건

1. `존재 보증` : 어떤 계약이 과거의 어느 시점에서 분명히 존재했다는 것을 보증해야 한다.

2. `고유성` : 계약 내용은 입장이 바뀌어도 변하지 않는 고유성을 유지해야 한다.

3. `자동화` : 계약 절차의 번거로움을 줄이고 계약 불이행의 위험을 방지하려면 계약을 자동으로 이행할 필요가 있다.

### 좁은 의미의 스마트 계약

- 이더리움 같은 블록체인 기반 플랫폼에서 동작하는 애플리케이션
- 이더리움은 특정 기업이나 단체가 사용자의 데이터를 독점할 수 없는 탈중앙화 네트워크에서 고유의 상태를 공유하는 컴퓨터를 구현하겠다는 목표를 둔 플랫폼이다.
- 이 네트워크 안에서 전 세계 사람이 소유한 가치(돈, 땅, 자동치, 여러 가지 권리 등)를 디지털로 표현한 후 애플리케이션을 이용해 서로 가치를 주고받겠다는 목표도 있다.

### 중앙화 모델과 탈중앙화 모델

- 기존 웹 서비스는 인터넷에 연결된 서버에서 애플리케이션을 실행해 서비스를 제공한다. - 이러한 웹서비스를 블록체인에서는 특정회사나 단체가 관리하는 서버에서 제공하는 것으로 여겨 `중앙화 모델`이라고 구분한다.
- `탈중앙화 모델` : 중앙화(특정 회사나 단체) 없이 불특정 다수의 참여자가 모인 네트워크에서 독립/분산형으로 시스템이 작동하는 모델

- `중앙화 모델`의 단점
  1. 서비스 사이의 상태 공유가 어려움
  2. 특정 서비스 제공자를 신뢰할 때의 위험함

### 블록체인의 특징

- 블록체인은 거래 정보가 담긴 원장을 네트워크 참여자 모두가 나누어 갖는 분산원장 기술의 하나다.
- 모두가 블록체인을 이용한 시스템을 유지하는 데 참여할 수 있고, 참여자 전체의 합의에 따라 새로운 데이터를 기록한다.
- 불특정 다수의 참여자가 데이터를 유지하므로 특정 사용자가 시스템을 제어하기 어려워 무신뢰 시스템을 실현할 수 있을 것으로 기대한다.

- 블록체인을 처음 도입한 암호화폐는 비트코인이다.
- 비트코인은 블록체인 기반으로 누구나 새로운 화폐를 발행, 송금하거나 `트랜잭션(거래, trasaction)`을 승인할 수 있다.
- 따라서 국가나 은행에 의존하지 않는 탈중앙화 전자화폐를 구현할 수 있다.

### 1. 합의 알고리즘

- 모든 참여자의 합의를 얻는 절차를 합의 알고리즘이라고 한다.
- 블록체인은 확률에 기반한 합의 알고리즘을 도입해 지금까지 불가능하다고 생각했던 불특정 다수 참여자의 합의 문제를 해결했다.
- 확률에 기반한 합의 알고리즘은 합의의 확실성을 확률로 정해 시간이 지날수록 과거 합의 내용을 뒤집기 어려운 구조다.
- 디지털 세계에서 합의의 성립 조건 중 하나는 합의가 이루어졌을 때 다시 뒤집지 않는다고 보장하는 것이다.
- 블록체인은 합의의 성립 조건을 느슨하게 재정의하고, 합의의 확실성을 확률로 결정해 불특정 다수 참여자의 합의 문제에 현실적인 해결 방법을 제공한다.

### 2. 블록체인의 합의 알고리즘

- 블록체인은 `블록 Block`이라는 데이터 단위마다 합의를 형성하며, 블록은 해시 함수를 이용해 앞뒤 관계를 맺는 `사슬 개념`으로 이어져 있다.
- 블록 하나는 트랜잭션을 포함하며, 트랜잭션에 따라 최신 상태가 변한다. (상태 : 계정 각각의 잔액 및 속성 정보 등)
- 새로운 블록은 불특정 다수의 참여자 중 어떤 1명이 생성한다.
- 블록체인에는 새로운 블록을 생성하는 권리를 공평하게 나누는 방법(알고리즘)이 있다.
- 블록체인을 사용한 최초의 암호화폐인 비트코인은 작업 증명이라는 알고리즘을 사용했다. (현재는 지분 증명 등 개선 알고리즘이 제안되고 있음)
- 블록체인에는 불특정 다수의 참여자가 협력해 시스템에 기여하는 행위에 보상을 주고(채굴), 시스템에 문제를 일으키는 행위에는 패널티를 주는 구조를 도입했다.
- 암호 경제학 : 블록체인을 이용한 시스템에서 ㅂ루특정 다수 참여자에게 주는 보상의 설계 방법을 연구하는 학문

### 3. 블록체인의 장점

1. 단일장애점을 없애며 높은 복원 능력 제공

- 불특정 다수의 참여자가 협력하여 운영하는 탈중앙화 모델 서비스는 지금까지 정지된 일이 없었다.

2. 가치 이전을 보장함

- 블록체인은 분산원장을 이용해 데이터의 소유권이나 양도 사실을 기록해서 디지털 데이터의 가치 이전을 보장한다.

#### 블록체인을 이용해 다양한 가치를 디지털로 표현하고, 가치의 소유권 증명이나 양도를 애플리케이션으로 자동화하는 것이 좁은 의미의 스마트 계약이다.

### 4. 탈중앙화 애플리케이션

- 블록체인의 스마트 계약을 이용하면 특정 회사나 단체의 서버에 의존하지 않는 탈중앙화 애플리케이션을 제공할 수 있다.
- 블록체인을 이용한 탈중앙화 애플리케이션(Decentralized Application)을 줄여서 DApps 라고 한다.
- 비트코인은 세계최초의 DApps, 이외에도 수 천개의 DApps가 등장

## 1.2 블록체인이 구현하는 것

- 블록체인을 활용하면 새로운 비즈니스 및 경제 모델을 구축할 수 있다. 혹은 기존 제품이나 서비스에 부분적으로 도입하는 것만으로도 사용자에게 새로운 경험과 가치를 제공할 수 있다.

### 블록 체인이 주는 다섯 가지 가치

1. 마이크로 지급 시스템 구현

- 1/1000 달러 단위의 소액 지급
- 아주 소액의 이용료를 청구할 수 있는 종량제 과금 서비스 (스마트폰 , 스마트가전, 스마트카 사물인터넷 지급 수단)
- 수십 수백억 대 기기에서 0.01원씩 서비스 이용료를 받는 마이크로 지급 시스템은 큰 수익을 낼 수 있음

2. 신용 거래보다 빠른 지급

- 기존의 신용거래 시스템과 비교했을 때 암호화폐 거래는 결제 발생에서 지급까지 걸리는 시간이 비교적 짧다.
- 암호화폐 시스템은 24시간 365일 중단 없이 운영한다.
- 매출 발생 수십 분 후에 그 금액을 자산으로 활용할 수 있는 암호화폐는 소규모 비즈니스에 큰 장점이다.
- 지금까지 과금하기 어려워 포기했던 새로운 서비스를 제공할 가능성도 커진다.

3. 위변조 방지

- 블록체인은 암호화폐의 이중 지급을 막으려고 고안한 기술로 과거 트랜잭션 내용의 조작을 쉽게 감지하는 데이터 구조다.
- 과거 데이터가 변조되면 블록과 블록의 연결에 무결성이 없어져 변경된 데이터를 포함하는 블록 다음에 모든 블록이 무결성을 유지할 수 있는 블록을 재생성해야 한다.
- 작업 증명 알고리즘을 사용하는 블록체인은 블록 하나를 생성하는 데 방대한 컴퓨팅 자원을 소비하기 때문에 과거의 블록을 다시 생성하면서 최신 블록 생성을 따라잡기 어렵다.
- 지분 증명 알고리즘을 사용하는 블록체인은 보유한 블록량에 따라 확률적으로 블록을 생성하는 `Node` 를 정하는 구조다.

  - 블록량이 충분히 분산되었으면, 노드 수도 적으므로 과거 블록을 재생성할 수 없다.
  - 이 데이터 구조를 응용해 다야한 분야에서 위변조를 막는 애플리케이션을 제공한다.

- 지금까지는 문서 위변조를 막으려고 행정 기관이나 3자 기관에서 계약을 중개하거나 내용을 감사해 대처했다.
  - 이 과정에서 많은 시간과 금전적 비용이 소모된다.
  - 문서를 디지털 데이터화하고, 전자 서명을 도입해 업무를 효율화하고 비용을 절감한다.
  - 하지만 전자 서명은 서명 시간을 보장할 수 없고, 전자 인증서를 관리할 기관도 있어야 하므로 완전한 해결 방법이 아니다.
- 블록체인을 이용한 애플리케이션을 도입하면 중개자나 인증 기관 등의 3자 없이도 과거 데이터를 언제 누가 만들었느닞와 변조 여부 등을 확인할 수 있다.
- 유언장이나 차용증 등의 개인 문서 공증 서비스, 위변조하지 않았음을 검증한 이력서 중심의 이직 소개 서비스 등 다양한 활용 가능성을 생각해볼 수 있다.

4. 데이터 공개

- 암호화폐 트랜잭션 내용은 블록체인의 분산원장에 기록되며, 전 세계 누구나 볼 수 있다.
- 트랜잭션 내용을 모두가 볼 수 있으면 과거 트랜잭션 내용에서 신용 정보를 분석하거나, 마케팅에 도움이 되는 시장 분석을 하는 등 데이터를 다양하게 활용할 수 있다.
- 물론 개인 생활에 관련한 모든 정보를 공개하는 데 염려가 있어 이 문제를 해결하는 암호화 기술 연구나 익명성 높은 암호화폐의 개발도 진행 중이다.
- `영지식 증명` 등의 암호화 기술을 이용하면 거래하는 상대방이나 거래 금액 등 숨기고 싶은 정보는 공개하지 않고, 거래했다는 사실과 정당성만 증명할 수 있다.
  - 이러한 기술로 각회사가 보유한 데이터를 공개하지 않고 데이터의 통계만을 계산할 수 있다.
- 다양한 블록체인 기반 애플리케이션으로 이용 내역을 블록체인에 축적하면 해당 데이터를 이용하는 새로운 서비스 제공도 가능하다.
  - 여러 의료 기관이 환자의 의료 기록을 공유해 가장 알맞은 치료를 제공하거나, 치료 사례를 효율적으로 수집 및 저장하거나, 한자의 건강 상태를 보험 회사와 공유해 최적의 보험을 제공하는 등 많은 서비스를 만들 수 있다.
- 이제까지 회사가 독점하던 데이터를 블록체인에 공개하고, 개인 정보의 공개 범이ㅜ를 개인이 직접 제어하는 상태에서 다른 서비스와 데이터를 공유하면 다양한 아이디어를 기반으로 새 서비스가 쉽게 탄생할 것이다.

5. 자동화한 스마트 계약

- 화폐나 권리 등 다양한 자산을 블록체인 데이터로 만들면, 애플리케이션을 실행해 자산 양도나 권리 행사 과정을 자동화할 수 있다.
- 그럼 오프라인에서 자산에 관한 권리를 행사할 때 발생하는 다양한 비용을 절감하고 효율성을 높일 수 있다.

  - 세금을 예로 들면 50 만원을 징수하기 위해 100 만원의 인건비가 나오면 과세 시스템이 성립할 수 업삳.
  - 블록체인으로 암호화한 자산이라면 소득, 보유 자산, 구입 제품 종류 등에 따라 자동으로 세율을 결정하고 애플리케이션으로 바로 징수하도록 만들 수 있다.
  - 주택이나 자동차 등의 키를 전자화하고 이용권을 블록체인 자산을 다룰 수 있다.
    - 이를 이용해 누군가에게 대여하는 공유 경제에 블록체인을 활용 가능

### 토큰 이코노미

- 기존의 비즈니스 모델과 경제권을 시각화하면 현재 문제점의 가서을 검증하거나 사용자를 분석하거나 숨어 있던 이해 관계자를 발견하는 등 정보를 알 수 있다.
- 이러한 과정으로 특정 서비스나 제품을 암호화폐(토큰 포함) 기반으로 특화한 소규모 경제권을 `토큰 이코노미`라고 한다.
- 이용자들에게 토큰으로 보상을 지급한다면 적극적인 활동을 장려할 수 있다.
- 비트코인이나 이더리움 기반 토큰을 지급하느냐 혹은 사용자가 직접 만든 토큰을 지급하느냐에 따라서도 사용자의 경험이 크게 바뀔 수 있다.
- 토큰 이코노미를 적용하면 서비스 가치 향상에 기여하는 서비스 설계에 참여하지 못했다는 이유 때문에 숨어 있는 '이해 관계자'를 찾을 수 있으며 혜택을 누려야할 사용자의 이익을 막는 불필요한 터치포인트(고객이 서비스와 상호작용하는 접점)도 많이 발견할 수 있다.

### 보상과 패널티 설계

- 커뮤니티 사용자 이용에 따른 토큰 부여
- 서비스에 참여한 보상을 빠르게 받을수록 사용자가 다음 작업을 빨리하는 동기가 부여됨

### 새로운 KYC 구축

- `KYC` : Know Your Customer = 고객 확인
- 보통 금융 기관에 계좌를 개설할 때 개인이나 회사가 존재하는지 확인하는 절차
- 블록체인은 '데이터 공개'나 '위변조 방지' 등의 특징을 활용하여 서비스나 특정 경제권의 거래 내역을 기초로 하는 행동 기록을 남길 수 있다.
- 즉, 개인 신용을 담보하는 3자 없이 자율 분산 구조로 신용을 담보하는 KYC의 축적이 가능하다.
- 탈중앙화 서비스를 특징으로 하는 DApps 는 신용을 담보하는 KYC 를 축적하므로 신용 거래뿐만 아니라 C2C 매칭 서비스 등에 크게 활용될 것으로 기대한다.

- 블록체인에서 KYC를 축적하면 행동 기록에 근거한 신용 정보도 늘어나는 것이므로 불필요한 프로세스 없이 좋거나 나쁜 사용자를 가릴 수 있다. (건전한 서비스 경험)

### DApps 개발에서 해결할 문제

1. 기술적 문제

- 글로벌 트랙잭션을 처리할 정도로 성능을 향상시켜야 한다는 확정성 scalability 문제
  - 크로스 체인 : 새로운 합의 알고리즘, 블록체인끼리 계층을 나눠 연결
  - 오픈 체인 : 거래하는 사람의 신용 판단을 메일 블록체인 밖에서 처리함
- 자산의 도난이나 동결 등을 막아 안전하게 블록체인을 이용할 보안 security 문제
  - 오류가 발생하기 어려운 토큰 설계
  - 버그가 발생하기 어려운 스마트 게약 플랫폼 구현
  - 문제 발생 시의 정책 수립

2. 사회적 문제

- DApps 때문에 불이익을 받는 이해 관계자가 없는지 충분히 검토
- 문제가 발생했을 때의 정책을 미리 정해둘 것
- 비밀 키나 사용자 주소라는 개념을 처음 접하는 사람도 직관적으로 사용할 수 있는 UI/UX 설계

## 1.3 기존 서비스 사례

### 블록체인을 이용한 서비스

1. 암호화폐

- 비트코인 : 누구에게도 자산 송금을 막지 않는 화폐 시스템을 제공할 수 있다는 것을 입증한 첫 사례이며 탈중앙화 시스템의 유효성을 전 세계에 입증한 사례이기도 하다.

2. 분산 DNS

- 네임코인 : 비트코인의 구조 그대로 DNS를 적용해 분산 DNS를 구측한 블록체인

3. 토큰 플랫폼

- 컬러드 코인 Colored Coin : 비트코인 블록체인 안에 자체 암호화폐 발행과 트랜잭션 정보를 포함시키는 비트코인 확장 프로토콜

4. 공증

- 문서의 효력을 증명하는 공증서비스 : NEM, 아포스티유
- NEM은 비트코인 블록체인의 기술적 문제를 개선해 새롭게 구현한 암호화폐 플랫폼으로 중요도 증명이라는 합의 알고리즘을 도입하고 다중 서명을 구현하는 등 성능과 보안을 향상시켰다.

5. 추적

- 블록체인의 투명성을 보석 거래 추적에 응용하는 에버레저

### 스마트 계약으로 구현한 서비스

1. 거래소 서비스

- 이더델타, 카이버 네트우크는 암호화폐를 교환하는 서비스인 분산거래소 이다.
  - 분산 거래소 애플리케이션에 버그가 없는 한 지갑을 도난당하거나 분실할 위험이 낮다.
  - 또한 지갑이 잇는 사용자라면 타 거래소 혹은 거래소를 이용하지 않는 개인과도 자유롭게 거래가 가능하다.

2. 게임 서비스

- 이더몬, 크립토키티

3. 장터 서비스

- 디센트럴랜드 : 온라인 VR 공간에서 땅을 매입/매매 할 수 있는 장터 서비스
- 비트페인팅 : 회화 등의 미술품을 고유 토큰화해 구입/매매할 수 있는 장터 서비스

4. 소셜 서비스

- 피페스 : 트위터와 비슷한 소셜 네트워크 서비스
  - 사용자가 남긴 게시물은 블록체인에 영구 저장 지울 수 없음
  - 사용자 사이에 토큰 송금도 쉽고, 팁으로 소액을 보내는 등의 커뮤니케이션이 가능
- 마인드 : 뉴스나 블로그 포스트 작성 비디오나 이미지 공유 등 다양한 콘텐츠로 커뮤니케이션하는 소셜 네트워크 서비스

5. 유틸리티 서비스

- 이더리움 네임 서비스 : 이더리움 기반 도메인 서비스
- 깃코인 : 깃허브에 공개한 애플리에키션 개발 프로젝트에 암호화폐로 보상을 주는 서비스
